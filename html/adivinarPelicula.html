<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adivina</title>
<style>
  /* Estilos CSS (código anterior) */
</style>
</head>
<body>

  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
    }
    .recuadro-imagen {
      margin: 20px auto;
      width: 500px; /* Se incrementó el ancho del recuadro */
      height: 700px;
      background-color: #eee;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden; /* Para recortar cualquier parte de la imagen que exceda el recuadro */
    }
    .recuadro-imagen img {
      width: auto;
      height: 100%;
    }

    #reintentarBoton {
    display: block;
    margin: 20px auto;
  }
  </style>

<h1 style="text-align: center;">Adivinaa!!!</h1>

<h1 id="peliculaActualDisplay" style="text-align: center;"></h1>

<div style="text-align: center;">
  <input type="text" id="letraInput" placeholder="Ingresa una letra" maxlength="1">
  <button onclick="probarLetra()">Probar</button>
  <p id="mensaje"></p>
  <p id="mensajeErrores"></p> <!-- Nuevo elemento para mostrar el mensaje de errores -->
</div>

<div style="text-align: center;">
  <p id="exitoMensaje"></p>
  <button id="reintentarBoton" style="display: none;" onclick="redirigirASeleccion()">Volver a jugar</button>
</div>

<div class="recuadro-imagen" id="recuadroImagen">
  <!-- Aquí se cargará la imagen correspondiente a los errores -->
</div>

<script>
  var peliculaActual = localStorage.getItem("peliculaActual");
  var peliculaActualDisplay = document.getElementById("peliculaActualDisplay");
  var recuadroImagen = document.getElementById("recuadroImagen");
  var letrasProbadas = [];
  var errores = 0;
  var maxErrores = 7; // Número máximo de errores permitidos

  if (peliculaActual) {
    var peliculaConGuiones = peliculaActual.split("").map(function(letra) {
      return letra === " " ? " " : "-";
    }).join("");

    peliculaActualDisplay.textContent = peliculaConGuiones;
  } else {
    peliculaActualDisplay.textContent = "Película no especificada";
  }

  function probarLetra() {
    var letraInput = document.getElementById("letraInput").value.trim().toUpperCase();
    
    if (letraInput.length !== 1) {
      document.getElementById("mensaje").textContent = "Ingresa solo una letra.";
      return;
    }

    if (letrasProbadas.indexOf(letraInput) !== -1) {
      document.getElementById("mensaje").textContent = "Ya probaste esta letra.";
      return;
    }

    letrasProbadas.push(letraInput);
    var letrasPelicula = peliculaActual.split("");
    var peliculaMostrada = peliculaActualDisplay.textContent.split("");

    var palabraCompleta = true; // Asumimos que la palabra está completa
    var letraCorrecta = false; // Asumimos que la letra no es correcta
    for (var i = 0; i < letrasPelicula.length; i++) {
      if (letrasPelicula[i].toUpperCase() === letraInput) {
        peliculaMostrada[i] = letrasPelicula[i];
        letraCorrecta = true;
      }
      if (peliculaMostrada[i] === "-") {
        palabraCompleta = false; // Si hay guiones, la palabra no está completa
      }
    }

    peliculaActualDisplay.textContent = peliculaMostrada.join("");
    document.getElementById("mensaje").textContent = "";

    if (!letraCorrecta) {
      errores++;
      cargarImagenErrores();
      
      if (errores >= maxErrores) {
        document.getElementById("letraInput").disabled = true;
        document.getElementById("reintentarBoton").style.display = "block";
        mostrarMensajeErrores();
      } else {
        mostrarMensajeErrores();
      }
    }

    if (palabraCompleta) {
      document.getElementById("exitoMensaje").textContent = "¡Adivinaste la película o serie!";
      document.getElementById("reintentarBoton").style.display = "block";
    }
  }

  function mostrarMensajeErrores() {
    var mensajeErrores = "";
    if (errores === 1) {
      mensajeErrores = "Ya le pifiaste...";
    } else if (errores >=2 && errores < 4){
      mensajeErrores = "Ojo abombaaaaado.";
    } else if (errores >=4 && errores < 6){
      mensajeErrores = "Menos mal que el macaco ese no es mi amigo";
    } else if (errores === 6) {
      mensajeErrores = "Ultimo intento... ojo que la queda el bicho";
    } else if (errores === 7){
      mensajeErrores = "Que medio imbécil... dedicate a otra cosa";
    } 
    document.getElementById("mensajeErrores").textContent = mensajeErrores;
  }

  function cargarImagenErrores() {
    recuadroImagen.innerHTML = '<img src="../img/errores' + errores + '.png">';
  }

  function redirigirASeleccion() {
    localStorage.removeItem("peliculaActual");
    window.location.href = "SeleccionarPelicula.html";
  }

  cargarImagenErrores();
  mostrarMensajeErrores(); // Agregar esta línea para mostrar el mensaje de errores inicialmente
</script>

</body>
</html>
